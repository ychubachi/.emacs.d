#+STARTUP: show2levels

ã“ã‚Œã ã‘ã¯çµ¶å¯¾ã«å¿…è¦ï¼ã¨æ€ãˆã‚‹è¨­å®šã€‚

* ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
** leafã®è¿½åŠ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

leafã«è¿½åŠ ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ã€‚

#+begin_src emacs-lisp
  (leaf *leaf-optional-packages
    :config
    (leaf leaf-convert
      :straight t)
    (leaf leaf-tree
      :straight t
      :custom ((imenu-list-size . 30)
               (imenu-list-position . 'left)))
    (leaf hydra
      :straight t)
;;    (leaf el-get
;;      :straight t
;;      :custom ((el-get-git-shallow-clone  . t)))
    (leaf diminish
      :straight t))
#+end_src

* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
** C-hã‚’BSã«ã™ã‚‹[C-h]

- [[https://www.emacswiki.org/emacs/BackspaceKey][[Home] Backspace Key]]
  - è¨˜è¿°ãŒé–“é•ã£ã¦ã„ã‚‹
- [[http://malkalech.com/emacs_c-h_backspace][Emacsã®C-hã§Backspaceã™ã‚‹ã®ã«ç´†ä½™æ›²æŠ˜ã—ãŸã“ã¨ã®ãƒ¡ãƒ¢ | Jenemal Notes]]

#+begin_src emacs-lisp
  (define-key key-translation-map [?\C-h] [?\C-?])
#+end_src

#+RESULTS:
: [127]

- æ¬¡ã®æ–¹æ³•ã ã¨pereditã§ã†ã¾ãã„ã‹ãªã„

#+begin_example
  (leaf *backspace
    :init (global-set-key (kbd "C-^") help-map)
    :bind (("C-h" . delete-backward-char)))
#+end_src

** C-^ã‚’ãƒ˜ãƒ«ãƒ—ã«ã™ã‚‹[C-^]

#+begin_src emacs-lisp
  (global-set-key (kbd "C-^") help-map)
#+end_src

** Undoã‚’C-zã«ã™ã‚‹[C-z]
- æŒ‡ãŒè¦šãˆã¦ã—ã¾ã£ã¦ã„ã‚‹

#+begin_src emacs-lisp
  (leaf *undo :bind (("C-z" . undo)))
#+end_src

#+RESULTS:
: *undo

* æ—¥æœ¬èªé–¢ä¿‚
** Linuxã§mozcã‚’ä½¿ã£ãŸæ—¥æœ¬èªå…¥åŠ›ã®è¨­å®šï¼ˆ2022å¹´ç‰ˆï¼‰                 :PBLISHED:
:PROPERTIES:
:EXPORT_FILE_NAME: ~/git/ploversky-jekyll/_posts/2022-10-01-linux-mozc.html
:EXPORT_OPTIONS:  toc:nil num:nil
:END:

#+begin_comment
First time: C-c C-e C-b C-s h h (Do this here)
Next  time: C-u C-c C-e         (Do this anyware in the subtree)
#+end_comment

#+begin_export html
---
layout: post
title: Linuxã§mozcã‚’ä½¿ã£ãŸæ—¥æœ¬èªå…¥åŠ›ã®è¨­å®šï¼ˆ2022å¹´ç‰ˆï¼‰
permalink: /archives/463
published: true
---
#+end_export

#+begin_comment
+ Mozcã®ãƒ­ãƒ¼ãƒå­—é…åˆ—ã®å¤‰æ›´æ–¹æ³•
  + mozc_toolã‚’åˆ©ç”¨ã™ã‚‹
  + /usr/lib/mozc/mozc_tool --mode=config_dialog
#+end_comment

*** èª¬æ˜
æ—¥æœ¬èªå…¥åŠ›å‘¨ã‚Šã®è¨­å®šã‚’è¦‹ç›´ã—ã¦ã¿ã¾ã—ãŸã€‚

- å‚è€ƒ
  - [[https://w.atwiki.jp/ntemacs/pages/48.html][emacs-mozc ã‚’å‹•ã‹ã™ãŸã‚ã®è¨­å®šï¼ˆEmacs è¨­å®šç·¨ï¼‰ - NTEmacs @ ã‚¦ã‚£ã‚­ - atwikiï¼ˆã‚¢ãƒƒãƒˆã‚¦ã‚£ã‚­ï¼‰]]

*** å…¨ä½“ã®è¨­å®š
Mozcã«é–¢é€£ã™ã‚‹è¨­å®šã®å…¨ä½“ã§ã™ã€‚å€‹åˆ¥ã®èª¬æ˜ã¯[[*Mozcã‚µãƒ¼ãƒã¨é€šä¿¡ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚³ãƒãƒ³ãƒ‰ã®è¨­å®š][ã“ã¡ã‚‰]]ã‹ã‚‰ã€‚

#+begin_src emacs-lisp :noweb yes
  (leaf mozc
    :straight t
    :config
    <<mozc-helper>>
    <<mozc-im>>
    <<mozc-cursor-color>>
    <<mozc-windows-advice>>)
#+end_src

#+RESULTS:
: mozc

*** Mozcã‚µãƒ¼ãƒã¨é€šä¿¡ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚³ãƒãƒ³ãƒ‰ã®è¨­å®š
Mozcã¨ã®ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’è¨­å®šã—ã¾ã™ã€‚
WSLç’°å¢ƒã§ã¯ã€mozc_emacs_helper.exeã«ç½®ãæ›ãˆã‚‹ã¨ã€Windowså´ã®Google IMEãŒä½¿ãˆã¾ã™ï¼ˆå¾Œè¿°ã®Windowsç”¨è¨­å®šãŒå¿…è¦ï¼‰ã€‚

+ [[https://w.atwiki.jp/ntemacs/pages/50.html][emacs-mozc ã‚’å‹•ã‹ã™ãŸã‚ã®è¨­å®šï¼ˆmozc_emacs_helper ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ç·¨ï¼‰ - NTEmacs @ ã‚¦ã‚£ã‚­ - atwikiï¼ˆã‚¢ãƒƒãƒˆã‚¦ã‚£ã‚­ï¼‰]]
+ [[https://w.atwiki.jp/ntemacs/pages/61.html][emacs-mozc ã‚’å‹•ã‹ã™ãŸã‚ã®è¨­å®šï¼ˆWSL è¨­å®šç·¨ï¼‰ - NTEmacs @ ã‚¦ã‚£ã‚­ - atwikiï¼ˆã‚¢ãƒƒãƒˆã‚¦ã‚£ã‚­ï¼‰]]

#+NAME: mozc-helper
#+begin_src emacs-lisp :tangle no
  (cond ((eq system-type 'windows-nt)
      (setq mozc-helper-program-name "~/Dropbox/bin/mozc_emacs_helper.exe"))
      (t (setq mozc-helper-program-name "mozc_emacs_helper")))
  ;; (if (getenv "WSLENV")
  ;;     ;; (setq mozc-helper-program-name "mozc_emacs_helper_win.sh")
  ;;     (setq mozc-helper-program-name "mozc_emacs_helper")
  ;;   (setq mozc-helper-program-name "mozc_emacs_helper"))
#+end_src

#+RESULTS: mozc-helper
: ~/Dropbox/bin/mozc_emacs_helper.exe

*** Mozcã«ã‚ˆã‚‹å¤‰æ›æ“ä½œã®è¨­å®š[C-o]

C-oã§å¤‰æ›ãƒ»ç„¡å¤‰æ›ã‚’ãƒˆã‚°ãƒ«ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ã¾ãŸã€ä»¥å‰ã¯ postframeã§å¤‰æ›å€™è£œã‚’å‡ºã—ã¦ã„ã¾ã—ãŸãŒã€X11ã‚’SSHã§ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã™ã‚‹ã¨é…ã„ã®ã§ã€ã‚¨ã‚³ãƒ¼ã‚¨ãƒªã‚¢ã«è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

#+NAME: mozc-im
#+begin_src emacs-lisp :tangle no :noweb yes
  (leaf mozc-im
    :straight t
    :require t
    :custom ((default-input-method . "japanese-mozc-im"))
    :bind* (("C-o" . toggle-input-method))
    :config
    (setq mozc-candidate-style 'echo-area))
#+end_src

#+RESULTS: mozc-im
: mozc-im

*** ã‚«ãƒ¼ã‚½ãƒ«ã‚«ãƒ©ãƒ¼ã‚’è¨­å®šã™ã‚‹
ç¾åœ¨ã®çŠ¶æ…‹ã«åˆã‚ã›ã¦ã€ã‚«ãƒ¼ã‚½ãƒ«ã®è‰²ã‚’è¨­å®šã—ã¾ã™ã€‚ã“ã®è¨­å®šã§ã¯ã€ç›´æ¥å…¥åŠ›ã®æ™‚ã¯ã‚°ãƒ¬ã‚¤ã€å¤‰æ›ãƒ¢ãƒ¼ãƒ‰ã®ã¨ãã¯ç·‘ã«ã—ã¦ã„ã¾ã™ã€‚ãƒªãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ¼ã§ã¯é»„è‰²ã«ãªã‚Šã¾ã™ã€‚ãã‚Œä»¥å¤–ã®çŠ¶æ…‹ã¯ã€ç§ã¯ä½¿ã„ã¾ã›ã‚“ãŒå¿µã®ç‚ºã€‚

ãªãŠã€Emacsã§ä½¿ãˆã‚‹ã‚«ãƒ©ãƒ¼ã®ä¸€è¦§ã¯ã€M-x list-colors-displayã§ç¢ºèªã§ãã¾ã™ã€‚

#+NAME: mozc-cursor-color
#+begin_src emacs-lisp :tangle no
  (leaf mozc-cursor-color
    :straight (mozc-cursor-color :type git :host github
                                 :repo "iRi-E/mozc-el-extensions")
    :require t
    :config
    (setq mozc-cursor-color-alist
          '((direct        . "gray")
            (read-only     . "yellow")
            (hiragana      . "green")
            (full-katakana . "goldenrod")
            (half-ascii    . "dark orchid")
            (full-ascii    . "orchid")
            (half-katakana . "dark goldenrod")))
    ;; mozc-cursor-color ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®å¯¾ç­–ï¼ˆNTEmacs@ã‚¦ã‚£ã‚­ã‚ˆã‚Šï¼‰
    (defvar-local mozc-im-mode nil)
    (add-hook 'mozc-im-activate-hook (lambda () (setq mozc-im-mode t)))
    (add-hook 'mozc-im-deactivate-hook (lambda () (setq mozc-im-mode nil)))
    (advice-add 'mozc-cursor-color-update
                :around (lambda (orig-fun &rest args)
                          (let ((mozc-mode mozc-im-mode))
                            (apply orig-fun args)))))
#+end_src

#+RESULTS: mozc-cursor-color
: mozc-cursor-color

*** Windowsç”¨adviceã®è¨­å®š

- https://w.atwiki.jp/ntemacs/pages/48.html
  - 5) ï¼ˆã€Œmozc_emacs_helper ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ç·¨ã€åˆ©ç”¨ã®å ´åˆï¼‰init.el ç­‰ã«ä»¥ä¸‹ã® elisp ã®è¨­å®šã‚’è¿½åŠ ã™ã‚‹ã€‚

#+NAME: mozc-windows-advice
#+begin_src emacs-lisp :tangle no
  (leaf *mozc-win
    :if (eq system-type 'windows-nt)
    :config
    (advice-add 'mozc-session-execute-command
	    :after (lambda (&rest args)
		     (when (eq (nth 0 args) 'CreateSession)
		       (mozc-session-sendkey '(Hankaku/Zenkaku))))))
#+end_src

*** COMMENT ãƒ¡ãƒ¢

#+begin_comment
- [[https://qiita.com/ignorant/items/1c4f729f9147fb878f10][WSL ã® Emacs ã§æ—¥æœ¬èªå…¥åŠ› - Qiita]]
  - Windowså´ã®Google IMEã‚’åˆ©ç”¨ã™ã‚‹
  - aptã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã¨æ€ã‚ã‚Œã‚‹mozc_emacs_helperï¼ˆãƒã‚¤ãƒŠãƒªï¼‰ã‚’ä½¿ã£ã¦ã¿ã‚‹ã€‚
    - æ—¢ã«è¨­å®šã•ã‚Œã¦ã„ãŸ
      [[https://github.com/smzht/mozc_emacs_helper][smzht/mozc_emacs_helper: mozc_emacs_helper for Windows]]
      ã“ã‚Œã¯Unixç”¨

- Windowsç”¨ã®mozc_emacs_helper.exeã‚’åˆ©ç”¨ã™ã‚‹
  - [[https://github.com/smzht/mozc_emacs_helper][smzht/mozc_emacs_helper: mozc_emacs_helper for Windows]]
    ã“ã“ã‹ã‚‰mozc_emacs_helper.exeã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦
    ~/Dropbox/bin/ä»¥ä¸‹ã«ãŠã„ã¦ãŠã

  - ~/bin/ã«mozc_emacs_helper_win.shã‚’ä½œæˆã™ã‚‹

    #+begin_src bash :tangle no
      #!/bin/sh

      ~/Dropbox/bin/mozc_emacs_helper.exe "$@" 2> /dev/null
    #+end_src
#+end_comment

#+begin_comment
IME ON  -> isearch -> OFF -> done -> ON
IME ON  -> isearch -> ON  -> done -> ON
IME OFF -> isearch -> ON  -> done -> ON*
IME OFF -> isearch -> OFF -> done -> OFF
*ã®ã¨ã“ã‚ã§çŠ¶æ…‹ãŒç‹‚ã†ã€‚
#+end_comment

** ãƒ•ã‚©ãƒ³ãƒˆã®è¨­å®šï¼ˆWindowsï¼‰

|mmmmmmmmmm|
|llllllllll|
|ã‚ã„ã†ãˆãŠ|
|1,2,3,4,5,|

|mm|
|ll|
|â™¥|
|ğŸ’‘|

#+begin_src emacs-lisp
  (when (eq system-type 'windows-nt)
    ;; é€šå¸¸ä½¿ç”¨ã™ã‚‹ãƒ•ã‚©ãƒ³ãƒˆ
    (set-frame-font "PlemolJP-12" nil t)
    ;; è¡Œé–“
    (setq-default line-spacing 0)
    ;; IMEæœªç¢ºå®šæ™‚ã®ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š
    (modify-all-frames-parameters '((ime-font . "PlemolJP-12"))))
#+end_src
